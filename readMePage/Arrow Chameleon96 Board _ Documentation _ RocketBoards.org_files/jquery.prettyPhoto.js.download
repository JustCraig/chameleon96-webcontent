(function(e){var t,i,a,r,o,l,n,p,s,d,h,c,f,u,m;e.prettyPhoto={version:"3.1.3"};e.fn.prettyPhoto=function(u){u=e.extend({animation_speed:"fast",slideshow:5e3,autoplay_slideshow:false,opacity:.8,show_title:true,title_attr:"alt",description_attr:"title",social:true,allow_resize:true,default_width:500,default_height:344,counter_separator_label:"/",theme:"pp_default",horizontal_padding:20,hideflash:false,wmode:"opaque",autoplay:true,modal:false,deeplinking:true,overlay_gallery:true,keyboard_shortcuts:true,changepicturecallback:function(){},callback:function(){},ie6_fallback:true,markup:'<div class="pp_pic_holder">'+'<div class="ppt">&nbsp;</div> '+'<div class="pp_top"> '+'<div class="pp_left"></div> '+'<div class="pp_middle"></div> '+'<div class="pp_right"></div> '+"</div> "+'<div class="pp_content_container"> '+'	<div class="pp_left"> '+'	<div class="pp_right"> '+'		<div class="pp_content"> '+'			<div class="pp_loaderIcon"></div> '+'			<div class="pp_fade"> '+'				<a href="#" class="pp_expand" title="Expand the image">Expand</a> '+'				<div class="pp_hoverContainer"> '+'					<a class="pp_next" href="#">next</a> '+'					<a class="pp_previous" href="#">previous</a> '+"				</div> "+'				<div id="pp_full_res"></div> '+'				<div class="pp_details"> '+'					<div class="pp_nav"> '+'						<a href="#" class="pp_arrow_previous">Previous</a> '+'						<p class="currentTextHolder">0/0</p> '+'						<a href="#" class="pp_arrow_next">Next</a> '+"					</div> "+'					<p class="pp_description"></p> '+"					{pp_social} "+'					<a class="pp_close" href="#">Close</a> '+"				</div> "+"			</div> "+"		</div> "+"	</div> "+"	</div>"+"</div> "+'<div class="pp_bottom"> '+'	<div class="pp_left"></div> '+'	<div class="pp_middle"></div> '+'	<div class="pp_right"></div> '+"</div> "+"</div> "+'<div class="pp_overlay"></div>',gallery_markup:'<div class="pp_gallery">'+'			<a href="#" class="pp_arrow_previous">Previous</a> '+"			<div> "+"				<ul> "+"					{gallery} "+"				</ul> "+"			</div> "+'			<a href="#" class="pp_arrow_next">Next</a> '+"		</div>",image_markup:'<img id="fullResImage" src="{path}" />',flash_markup:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{path}" /><embed src="{path}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',quicktime_markup:'<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" height="{height}" width="{width}"><param name="src" value="{path}"><param name="autoplay" value="{autoplay}"><param name="type" value="video/quicktime"><embed src="{path}" height="{height}" width="{width}" autoplay="{autoplay}" type="video/quicktime" pluginspage="http://www.apple.com/quicktime/download/"></embed></object>',iframe_markup:'<iframe src ="{path}" width="{width}" height="{height}" frameborder="no"></iframe>',inline_markup:'<div class="pp_inline">{content}</div>',custom_markup:"",social_tools:'<div class="pp_social"><div class="twitter"><a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script></div><div class="facebook"><iframe src="http://www.facebook.com/plugins/like.php?locale=en_US&href={location_href}&amp;layout=button_count&amp;show_faces=true&amp;width=500&amp;action=like&amp;font&amp;colorscheme=light&amp;height=23" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:500px; height:23px;" allowTransparency="true"></iframe></div></div>'},u);var m=this,w=false,y,b,P,k,x,I,j=e(window).height(),T=e(window).width(),C;c=true,f=q();e(window).unbind("resize.prettyphoto").bind("resize.prettyphoto",function(){S();M()});if(u.keyboard_shortcuts){e(document).unbind("keydown.prettyphoto").bind("keydown.prettyphoto",function(a){if(typeof t!=="undefined"){if(t.is(":visible")){switch(a.keyCode){case 37:e.prettyPhoto.changePage("previous");a.preventDefault();break;case 39:e.prettyPhoto.changePage("next");a.preventDefault();break;case 27:if(!i.modal){e.prettyPhoto.close()}a.preventDefault();break}}}})}e.prettyPhoto.initialize=function(){i=u;if(i.theme=="pp_default"){i.horizontal_padding=16}if(i.ie6_fallback&&e.browser.msie&&parseInt(e.browser.version,10)==6){i.theme="light_square"}a=e(this).attr("rel");var t=/\[(?:.*)\]/;r=t.exec(a)?true:false;o=r?e.map(m,function(t,i){if(e(t).attr("rel").indexOf(a)!=-1){return e(t).attr("href")}}):e.makeArray(e(this).attr("href"));l=r?e.map(m,function(t,r){if(e(t).attr("rel").indexOf(a)!=-1){return e(t).attr(i.title_attr)?e(t).attr(i.title_attr):""}}):e.makeArray(e(this).find("img").attr("alt"));n=r?e.map(m,function(t,r){if(e(t).attr("rel").indexOf(a)!=-1){return e(t).attr(i.description_attr)?e(t).attr(i.description_attr):""}}):e.makeArray(e(this).attr("title"));if(o.length>30){i.overlay_gallery=false}p=e.inArray(e(this).attr("href"),o);s=r?p:e("a[rel^='"+a+"']").index(e(this));A(this);if(i.allow_resize){e(window).bind("scroll.prettyphoto",function(){S()})}e.prettyPhoto.open();return false};e.prettyPhoto.open=function(a){var s,f,m;if(typeof i==="undefined"){i=u;if(e.browser.msie&&e.browser.version==6){i.theme="light_square"}o=e.makeArray(arguments[0]);l=arguments[1]?e.makeArray(arguments[1]):e.makeArray("");n=arguments[2]?e.makeArray(arguments[2]):e.makeArray("");r=o.length>1?true:false;p=0;A(a.target)}if(e.browser.msie&&e.browser.version==6){e("select").css("visibility","hidden")}if(i.hideflash){e("object,embed,iframe[src*=youtube],iframe[src*=vimeo]").css("visibility","hidden")}$(e(o).size());e(".pp_loaderIcon").show();if(i.deeplinking){_()}if(i.social){s=i.social_tools.replace("{location_href}",encodeURIComponent(window.location.href));t.find(".pp_social").html(s)}if(d.is(":hidden")){d.css("opacity",0).show()}h.show().fadeTo(i.animation_speed,i.opacity);t.find(".currentTextHolder").text(p+1+i.counter_separator_label+e(o).size());if(n[p]!=""){t.find(".pp_description").show().html(unescape(n[p]))}else{t.find(".pp_description").hide()}f=parseFloat(v("width",o[p]))?v("width",o[p]):i.default_width.toString();m=parseFloat(v("height",o[p]))?v("height",o[p]):i.default_height.toString();w=false;if(m.indexOf("%")!=-1){m=parseFloat(e(window).height()*parseFloat(m)/100-150);w=true}if(f.indexOf("%")!=-1){f=parseFloat(e(window).width()*parseFloat(f)/100-150);w=true}t.fadeIn(function(){i.show_title&&l[p]!=""&&typeof l[p]!=="undefined"?d.html(unescape(l[p])):d.html("&nbsp;");var a="",n=false,s,h,u;switch(G(o[p])){case"image":a=new Image;s=new Image;if(r&&p<e(o).size()-1){s.src=o[p+1]}h=new Image;if(r&&o[p-1]){h.src=o[p-1]}t.find("#pp_full_res")[0].innerHTML=i.image_markup.replace(/\{path\}/g,o[p]);a.onload=function(){y=O(a.width,a.height);H()};a.onerror=function(){alert("Image cannot be loaded. Make sure the path is correct and image exist.");e.prettyPhoto.close()};a.src=o[p];break;case"youtube":y=O(f,m);u=v("v",o[p]);if(u==""){u=o[p].split("youtu.be/");u=u[1];if(u.indexOf("?")>0){u=u.substr(0,u.indexOf("?"))}if(u.indexOf("&")>0){u=u.substr(0,u.indexOf("&"))}}movie="http://www.youtube.com/embed/"+u;v("rel",o[p])?movie+="?rel="+v("rel",o[p]):movie+="?rel=1";if(i.autoplay)movie+="&autoplay=1";toInject=i.iframe_markup.replace(/{width}/g,y["width"]).replace(/{height}/g,y["height"]).replace(/{wmode}/g,i.wmode).replace(/{path}/g,movie);break;case"vimeo":y=O(f,m);u=o[p];var g=/http:\/\/(www\.)?vimeo.com\/(\d+)/;var _=u.match(g);movie="http://player.vimeo.com/video/"+_[2]+"?title=0&amp;byline=0&amp;portrait=0";if(i.autoplay)movie+="&autoplay=1;";vimeo_width=y["width"]+"/embed/?moog_width="+y["width"];toInject=i.iframe_markup.replace(/{width}/g,vimeo_width).replace(/{height}/g,y["height"]).replace(/{path}/g,movie);break;case"quicktime":y=O(f,m);y["height"]+=15;y["contentHeight"]+=15;y["containerHeight"]+=15;toInject=i.quicktime_markup.replace(/{width}/g,y["width"]).replace(/{height}/g,y["height"]).replace(/{wmode}/g,i.wmode).replace(/{path}/g,o[p]).replace(/{autoplay}/g,i.autoplay);break;case"flash":y=O(f,m);flash_vars=o[p];flash_vars=flash_vars.substring(o[p].indexOf("flashvars")+10,o[p].length);filename=o[p];filename=filename.substring(0,filename.indexOf("?"));toInject=i.flash_markup.replace(/{width}/g,y["width"]).replace(/{height}/g,y["height"]).replace(/{wmode}/g,i.wmode).replace(/{path}/g,filename+"?"+flash_vars);break;case"iframe":y=O(f,m);frame_url=o[p];frame_url=frame_url.substr(0,frame_url.indexOf("iframe")-1);toInject=i.iframe_markup.replace(/{width}/g,y["width"]).replace(/{height}/g,y["height"]).replace(/{path}/g,frame_url);break;case"ajax":c=false;y=O(f,m);c=true;n=true;e.get(o[p],function(e){toInject=i.inline_markup.replace(/{content}/g,e);t.find("#pp_full_res")[0].innerHTML=toInject;H()});break;case"custom":y=O(f,m);toInject=i.custom_markup;break;case"inline":myClone=e(o[p]).clone().append('<br clear="all" />').css({width:i.default_width}).wrapInner('<div id="pp_full_res"><div class="pp_inline"></div></div>').appendTo(e("body")).show();c=false;y=O(e(myClone).width(),e(myClone).height());c=true;e(myClone).remove();toInject=i.inline_markup.replace(/{content}/g,e(o[p]).html());break}if(!a&&!n){t.find("#pp_full_res")[0].innerHTML=toInject;H()}});return false};e.prettyPhoto.changePage=function(t){currentGalleryPage=0;if(t=="previous"){p--;if(p<0)p=e(o).size()-1}else if(t=="next"){p++;if(p>e(o).size()-1)p=0}else{p=t}s=p;if(!c)c=true;e(".pp_contract").removeClass("pp_contract").addClass("pp_expand");W(function(){e.prettyPhoto.open()})};e.prettyPhoto.changeGalleryPage=function(e){if(e=="next"){currentGalleryPage++;if(currentGalleryPage>totalPage)currentGalleryPage=0}else if(e=="previous"){currentGalleryPage--;if(currentGalleryPage<0)currentGalleryPage=totalPage}else{currentGalleryPage=e}slide_speed=e=="next"||e=="previous"?i.animation_speed:0;slide_to=currentGalleryPage*(itemsPerPage*itemWidth);$pp_gallery.find("ul").animate({left:-slide_to},slide_speed)};e.prettyPhoto.startSlideshow=function(){if(typeof C==="undefined"){t.find(".pp_play").unbind("click").removeClass("pp_play").addClass("pp_pause").click(function(){e.prettyPhoto.stopSlideshow();return false});C=setInterval(e.prettyPhoto.startSlideshow,i.slideshow)}else{e.prettyPhoto.changePage("next")}};e.prettyPhoto.stopSlideshow=function(){t.find(".pp_pause").unbind("click").removeClass("pp_pause").addClass("pp_play").click(function(){e.prettyPhoto.startSlideshow();return false});clearInterval(C);C=undefined};e.prettyPhoto.close=function(){if(h.is(":animated"))return;e.prettyPhoto.stopSlideshow();t.stop().find("object,embed").css("visibility","hidden");e("div.pp_pic_holder,div.ppt,.pp_fade").fadeOut(i.animation_speed,function(){e(this).remove()});h.fadeOut(i.animation_speed,function(){if(e.browser.msie&&e.browser.version==6)e("select").css("visibility","visible");if(i.hideflash)e("object,embed,iframe[src*=youtube],iframe[src*=vimeo]").css("visibility","visible");e(this).remove();e(window).unbind("scroll.prettyphoto");i.callback();c=true;b=false;delete i})};function H(){e(".pp_loaderIcon").hide();projectedTop=f["scrollTop"]+(j/2-y["containerHeight"]/2);if(projectedTop<0){projectedTop=0}d.fadeTo(i.animation_speed,1);t.find(".pp_content").animate({height:y["contentHeight"],width:y["contentWidth"]},i.animation_speed);t.animate({top:projectedTop,left:T/2-y["containerWidth"]/2,width:y["containerWidth"]},i.animation_speed,function(){t.find(".pp_hoverContainer,#fullResImage").height(y["height"]).width(y["width"]);t.find(".pp_fade").fadeIn(i.animation_speed);if(r&&G(o[p])=="image"){t.find(".pp_hoverContainer").show()}else{t.find(".pp_hoverContainer").hide()}if(y["resized"]){e("a.pp_expand,a.pp_contract").show()}else{e("a.pp_expand").hide()}if(i.autoplay_slideshow&&!C&&!b)e.prettyPhoto.startSlideshow();i.changepicturecallback();b=true});F()}function W(a){t.find("#pp_full_res object,#pp_full_res embed").css("visibility","hidden");t.find(".pp_fade").fadeOut(i.animation_speed,function(){e(".pp_loaderIcon").show();a()})}function $(t){t>1?e(".pp_nav").show():e(".pp_nav").hide()}function O(e,t){resized=false;z(e,t);imageWidth=e,imageHeight=t;if((I>T||x>j)&&c&&i.allow_resize&&!w){resized=true,fitting=false;while(!fitting){if(I>T){imageWidth=T-200;imageHeight=t/e*imageWidth}else if(x>j){imageHeight=j-200;imageWidth=e/t*imageHeight}else{fitting=true}x=imageHeight,I=imageWidth}z(imageWidth,imageHeight);if(I>T||x>j){O(I,x)}}return{width:Math.floor(imageWidth),height:Math.floor(imageHeight),containerHeight:Math.floor(x),containerWidth:Math.floor(I)+i.horizontal_padding*2,contentHeight:Math.floor(P),contentWidth:Math.floor(k),resized:resized}}function z(a,r){a=parseFloat(a);r=parseFloat(r);$pp_details=t.find(".pp_details");$pp_details.width(a);detailsHeight=parseFloat($pp_details.css("marginTop"))+parseFloat($pp_details.css("marginBottom"));$pp_details=$pp_details.clone().addClass(i.theme).width(a).appendTo(e("body")).css({position:"absolute",top:-1e4});detailsHeight+=$pp_details.height();detailsHeight=detailsHeight<=34?36:detailsHeight;if(e.browser.msie&&e.browser.version==7)detailsHeight+=8;$pp_details.remove();$pp_title=t.find(".ppt");$pp_title.width(a);titleHeight=parseFloat($pp_title.css("marginTop"))+parseFloat($pp_title.css("marginBottom"));$pp_title=$pp_title.clone().appendTo(e("body")).css({position:"absolute",top:-1e4});titleHeight+=$pp_title.height();$pp_title.remove();P=r+detailsHeight;k=a;x=P+titleHeight+t.find(".pp_top").height()+t.find(".pp_bottom").height();I=a}function G(e){if(e.match(/youtube\.com\/watch/i)||e.match(/youtu\.be/i)){return"youtube"}else if(e.match(/vimeo\.com/i)){return"vimeo"}else if(e.match(/\b.mov\b/i)){return"quicktime"}else if(e.match(/\b.swf\b/i)){return"flash"}else if(e.match(/\biframe=true\b/i)){return"iframe"}else if(e.match(/\bajax=true\b/i)){return"ajax"}else if(e.match(/\bcustom=true\b/i)){return"custom"}else if(e.substr(0,1)=="#"){return"inline"}else{return"image"}}function S(){var e,i;if(c&&typeof t!=="undefined"){f=q();e=t.height(),i=t.width();projectedTop=j/2+f["scrollTop"]-e/2;if(projectedTop<0){projectedTop=0}if(e>j){return}t.css({top:projectedTop,left:T/2+f["scrollLeft"]-i/2})}}function q(){if(self.pageYOffset){return{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset}}else if(document.documentElement&&typeof document.documentElement.scrollTop!=="undefined"){return{scrollTop:document.documentElement.scrollTop,scrollLeft:document.documentElement.scrollLeft}}else if(document.body){return{scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft}}}function M(){j=e(window).height(),T=e(window).width();if(typeof h!=="undefined"){h.height(e(document).height()).width(T)}}function F(){if(r&&i.overlay_gallery&&G(o[p])=="image"&&(i.ie6_fallback&&!(e.browser.msie&&parseInt(e.browser.version)==6))){itemWidth=52+5;navWidth=i.theme=="facebook"||i.theme=="pp_default"?50:30;itemsPerPage=Math.floor((y["containerWidth"]-100-navWidth)/itemWidth);itemsPerPage=itemsPerPage<o.length?itemsPerPage:o.length;totalPage=Math.ceil(o.length/itemsPerPage)-1;if(totalPage==0){navWidth=0;$pp_gallery.find(".pp_arrow_next,.pp_arrow_previous").hide()}else{$pp_gallery.find(".pp_arrow_next,.pp_arrow_previous").show()}galleryWidth=itemsPerPage*itemWidth;fullGalleryWidth=o.length*itemWidth;$pp_gallery.css("margin-left",-(galleryWidth/2+navWidth/2)).find("div:first").width(galleryWidth+5).find("ul").width(fullGalleryWidth).find("li.selected").removeClass("selected");goToPage=Math.floor(p/itemsPerPage)<totalPage?Math.floor(p/itemsPerPage):totalPage;e.prettyPhoto.changeGalleryPage(goToPage);$pp_gallery_li.filter(":eq("+p+")").addClass("selected")}else{t.find(".pp_content").unbind("mouseenter mouseleave")}}function A(a){var l;if(i.social)l=i.social_tools.replace("{location_href}",encodeURIComponent(window.location.href));i.markup=i.markup.replace("{pp_social}",i.social?l:"");e("body").append(i.markup);t=e(".pp_pic_holder"),d=e(".ppt"),h=e("div.pp_overlay");if(r&&i.overlay_gallery){currentGalleryPage=0;toInject="";for(var n=0;n<o.length;n++){if(!o[n].match(/\b(jpg|jpeg|png|gif)\b/gi)){classname="default";img_src=""}else{classname="";img_src=o[n]}toInject+="<li class='"+classname+"'><a href='#'><img src='"+img_src+"' width='50' alt='' /></a></li>"}toInject=i.gallery_markup.replace(/{gallery}/g,toInject);t.find("#pp_full_res").after(toInject);$pp_gallery=e(".pp_pic_holder .pp_gallery"),$pp_gallery_li=$pp_gallery.find("li");$pp_gallery.find(".pp_arrow_next").click(function(){e.prettyPhoto.changeGalleryPage("next");e.prettyPhoto.stopSlideshow();return false});$pp_gallery.find(".pp_arrow_previous").click(function(){e.prettyPhoto.changeGalleryPage("previous");e.prettyPhoto.stopSlideshow();return false});t.find(".pp_content").hover(function(){t.find(".pp_gallery:not(.disabled)").fadeIn()},function(){t.find(".pp_gallery:not(.disabled)").fadeOut()});itemWidth=52+5;$pp_gallery_li.each(function(t){e(this).find("a").click(function(){e.prettyPhoto.changePage(t);e.prettyPhoto.stopSlideshow();return false})})}if(i.slideshow){t.find(".pp_nav").prepend('<a href="#" class="pp_play">Play</a>');t.find(".pp_nav .pp_play").click(function(){e.prettyPhoto.startSlideshow();return false})}t.attr("class","pp_pic_holder "+i.theme);h.css({opacity:0,height:e(document).height(),width:e(window).width()}).bind("click",function(){if(!i.modal)e.prettyPhoto.close()});e("a.pp_close").bind("click",function(){e.prettyPhoto.close();return false});e("a.pp_expand").bind("click",function(t){if(e(this).hasClass("pp_expand")){e(this).removeClass("pp_expand").addClass("pp_contract");c=false}else{e(this).removeClass("pp_contract").addClass("pp_expand");c=true}W(function(){e.prettyPhoto.open()});return false});t.find(".pp_previous, .pp_nav .pp_arrow_previous").bind("click",function(){e.prettyPhoto.changePage("previous");e.prettyPhoto.stopSlideshow();return false});t.find(".pp_next, .pp_nav .pp_arrow_next").bind("click",function(){e.prettyPhoto.changePage("next");e.prettyPhoto.stopSlideshow();return false});S()}if(!pp_alreadyInitialized&&g()){pp_alreadyInitialized=true;hashIndex=g();hashRel=hashIndex;hashIndex=hashIndex.substring(hashIndex.indexOf("/")+1,hashIndex.length-1);hashRel=hashRel.substring(0,hashRel.indexOf("/"));setTimeout(function(){e("a[rel^='"+hashRel+"']:eq("+hashIndex+")").trigger("click")},50)}return this.unbind("click.prettyphoto").bind("click.prettyphoto",e.prettyPhoto.initialize)};function g(){url=window.location.href;hashtag=url.indexOf("#!")!=-1?decodeURI(url.substring(url.indexOf("#!")+2,url.length)):false;return hashtag}function _(){if(typeof a==="undefined")return;window.location.hash="!"+a+"/"+s+"/"}function w(){url=window.location.href;hashtag=url.indexOf("#!prettyPhoto")?true:false;if(hashtag)window.location.hash="!prettyPhoto"}function v(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+e+"=([^&#]*)";var a=new RegExp(i);var r=a.exec(t);return r==null?"":r[1]}})(jQuery);var pp_alreadyInitialized=false;
