(function(e){var n={render:"on",zones:"script, head"};function o(o){var t=this;t.successFunc=o.success||function(){},t.errorFunc=o.error||function(){},t.url=o.url||foswiki.getPreference("SCRIPTURL")+"/rest/RenderPlugin/jsonTemplate";delete o.success;delete o.error;delete o.url;t.opts=e.extend({},n,o)}o.prototype.log=function(){var n=this,o=e.makeArray(arguments);o.unshift("JST: ");e.log.apply(n,o)};o.prototype.loadTemplate=function(){var n=this;e.ajax({url:n.url,data:n.opts,dataType:"json",success:function(e,o,t){n.processZones(e.zones);n.successFunc(e.expand,o,t)},error:function(e,o,t){n.errorFunc(e,o,t)}})};o.prototype.processZones=function(n){var o=this;e.each(n,function(t){var r=n[t],s=e("."+t).last();e.each(r,function(n){var a=r[n],c="."+t+"."+a.id.replace(/([^a-zA-Z0-9_\-])/g,"\\$1");if(!a.id.match(/^(JQUERYPLUGIN::FOSWIKI::PREFERENCES)?$/)){if(e(c).length>0){o.log("zone=",t,"item ",a.id+" already loaded")}else{o.log("... loading ",a.id,"to zone",t);window.setTimeout(function(){s.after(a.text)})}}})})};foswiki.loadTemplate=function(e){var n=new o(e);return n.loadTemplate()}})(jQuery);