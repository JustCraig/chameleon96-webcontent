jQuery(function(i){var e={width:300,autoOpen:false,draggable:false,resizable:false,closeOnEscape:false,show:"fade"},t={cache:true};i(".jqUIDialog").livequery(function(){var t=i(this),a=i.extend({},e,t.metadata()),o=[];if(t.data("autoOpen")){a.autoOpen=true}if(!t.data("cached")){a.close=function(){t.dialog("destroy");t.remove()}}t.find(".jqUIDialogButton").each(function(){var e=i(this),a={},n=e.attr("href");a.text=e.text();if(typeof n!=="undefined"&&n!=="#"){a.click=function(){window.location.href=n}}if(e.is(".jqUIDialogClose")){a.click=function(){t.dialog("close")}}if(e.is(".jqUIDialogDestroy")){a.click=function(){t.dialog("destroy");t.remove()}}if(e.is(".jqUIDialogSubmit")){a.click=function(){t.find("form:first").submit()}}i.extend(a,e.metadata());if(typeof a.click==="undefined"){a.click=function(){}}if(typeof a.icon!=="undefined"){a.icons={primary:a.icon}}o.push(a)}).remove();if(o.length){a.buttons=o}if(a.autoCenter){i(window).bind("resize",function(){t.dialog("option","position","center")});a.draggable=false}t.removeClass("jqUIDialog").dialog(a);if(a.alsoResize){t.dialog("widget").bind("resize",function(e,o){var n=o.size.height-o.originalSize.height||0,d=o.size.width-o.originalSize.width||0;t.find(a.alsoResize).each(function(){var e=i(this),t=e.data("origHeight"),a=e.data("origWidth");if(typeof t==="undefined"){t=e.height();e.data("origHeight",t)}if(typeof a==="undefined"){a=e.width();e.data("origWidth",a)}e.height(t+n);e.width(a+d)})})}});i(document).on("click",".jqUIDialogLink",function(){var e=i(this),a=e.attr("href"),o=i.extend({},t,e.metadata());if(a.match(/^(https?:)|\//)){i.ajax({url:a,success:function(t){var a=i(t),n=a.attr("id");if(!n){n="dialog-"+foswiki.getUniqueID();a.attr("id",n)}if(o.cache){e.attr("href","#"+n);a.data("cached",true)}else{a.data("cached",false)}a.hide();i("body").append(a);a.data("autoOpen",true)},error:function(i){throw"ERROR: can't load dialog xhr=",i}})}else{i(a).dialog("open")}return false})});